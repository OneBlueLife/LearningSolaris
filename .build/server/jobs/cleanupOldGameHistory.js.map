{
  "version": 3,
  "sources": ["../../../server/jobs/cleanupOldGameHistory.ts"],
  "sourcesContent": ["import { DependencyContainer } from \"../services/types/DependencyContainer\";\n\nexport default (container: DependencyContainer) => {\n\n    /*\n        Delete game history for games that completed more than 1 month ago.\n    */\n    const months = 1;\n\n    return {\n\n        async handler(job, done) {\n            let games = await container.gameListService.listOldCompletedGamesNotCleaned(months);\n\n            for (let i = 0; i < games.length; i++) {\n                let game = games[i];\n\n                console.log(`Deleting history for old game: ${game._id}`);\n\n                try {\n                    await container.historyService.deleteByGameId(game._id);\n                    await container.eventService.deleteByGameId(game._id);\n                    await container.gameService.markAsCleaned(game._id);\n                } catch (e) {\n                    console.error(e);\n                }\n            }\n\n            console.log('Cleanup completed.');\n\n            done();\n        }\n\n    };\n    \n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,IAAO,gCAAQ,CAAC,cAAmC;AAK/C,QAAM,SAAS;AAEf,SAAO;AAAA,IAEH,MAAM,QAAQ,KAAK,MAAM;AACrB,UAAI,QAAQ,MAAM,UAAU,gBAAgB,gCAAgC,MAAM;AAElF,eAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK;AACnC,YAAI,OAAO,MAAM;AAEjB,gBAAQ,IAAI,kCAAkC,KAAK,KAAK;AAExD,YAAI;AACA,gBAAM,UAAU,eAAe,eAAe,KAAK,GAAG;AACtD,gBAAM,UAAU,aAAa,eAAe,KAAK,GAAG;AACpD,gBAAM,UAAU,YAAY,cAAc,KAAK,GAAG;AAAA,QACtD,SAAS,GAAP;AACE,kBAAQ,MAAM,CAAC;AAAA,QACnB;AAAA,MACJ;AAEA,cAAQ,IAAI,oBAAoB;AAEhC,WAAK;AAAA,IACT;AAAA,EAEJ;AAEJ;",
  "names": []
}
