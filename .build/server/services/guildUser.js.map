{
  "version": 3,
  "sources": ["../../../server/services/guildUser.ts"],
  "sourcesContent": ["import { DBObjectId } from \"./types/DBObjectId\";\nimport Repository from \"./repository\";\nimport { User } from \"./types/User\";\nimport GuildService from \"./guild\";\nimport { GuildUserWithTag } from \"./types/Guild\";\n\nexport default class UserGuildService {\n    userRepo: Repository<User>;\n    guildService: GuildService;\n    \n    constructor(\n        userRepo: Repository<User>,\n        guildService: GuildService\n    ) {\n        this.userRepo = userRepo;\n        this.guildService = guildService;\n    }\n\n    async listUsersWithGuildTags(userIds: DBObjectId[]): Promise<GuildUserWithTag[]> {\n        let users = await this.userRepo.find({\n            _id: {\n                $in: userIds\n            }\n        }, {\n            username: 1,\n            guildId: 1,\n            'gameSettings.guild.displayGuildTag': 1\n        });\n\n        let guildIds = users.filter(x => x.guildId).map(x => x.guildId!);\n\n        let guilds = await this.guildService.listInfoByIds(guildIds);\n        \n        return users.map(u => {\n            return {\n                _id: u._id,\n                username: u.username,\n                displayGuildTag: u.gameSettings.guild.displayGuildTag,\n                guild: guilds.find(g => u.guildId && g._id.toString() === u.guildId.toString()) || null\n            };\n        });\n    }\n\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,MAAO,iBAA+B;AAAA,EAIlC,YACI,UACA,cACF;AACE,SAAK,WAAW;AAChB,SAAK,eAAe;AAAA,EACxB;AAAA,EAEA,MAAM,uBAAuB,SAAoD;AAC7E,QAAI,QAAQ,MAAM,KAAK,SAAS,KAAK;AAAA,MACjC,KAAK;AAAA,QACD,KAAK;AAAA,MACT;AAAA,IACJ,GAAG;AAAA,MACC,UAAU;AAAA,MACV,SAAS;AAAA,MACT,sCAAsC;AAAA,IAC1C,CAAC;AAED,QAAI,WAAW,MAAM,OAAO,OAAK,EAAE,OAAO,EAAE,IAAI,OAAK,EAAE,OAAQ;AAE/D,QAAI,SAAS,MAAM,KAAK,aAAa,cAAc,QAAQ;AAE3D,WAAO,MAAM,IAAI,OAAK;AAClB,aAAO;AAAA,QACH,KAAK,EAAE;AAAA,QACP,UAAU,EAAE;AAAA,QACZ,iBAAiB,EAAE,aAAa,MAAM;AAAA,QACtC,OAAO,OAAO,KAAK,OAAK,EAAE,WAAW,EAAE,IAAI,SAAS,MAAM,EAAE,QAAQ,SAAS,CAAC,KAAK;AAAA,MACvF;AAAA,IACJ,CAAC;AAAA,EACL;AAEJ;AAAC;",
  "names": []
}
